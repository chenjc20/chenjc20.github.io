---
title: Exploiting Combined Locality for Wide-Stripe Erasure Coding in Distributed Storage
tags: EC Wide-Stripe Combined Locality 
categories: FAST
author: 何汉宇
---

这篇文章主要讲述的是分布式系统中利用组合局部性的宽列（Wide-Stripe）Erasure coding（EC）方法，本文将现有的两种利用局部性的编码方法进行了有效均衡的结合，实现了跨机架的低网络传输和低冗余度的效果。该工作是由华中科技大学的Yuchong Hu, Liangfeng Cheng, Qiaori Yao、香港中文大学的Patrick P. C. Lee以及海康威视的Weichun Wang, Wei Chen完成。

## 问题背景

EC是一种低成本的分布式存储冗余机制，通过存储数据块和奇偶校验块来实现。宽列通过增加数据块的数量且保持校验块的数量不变来降低存储冗余度，节省了大量存储空间。然而宽列提高了恢复成本，对于现有的较高效率的EC恢复方法来说依然不能有效地解决该问题。

## 主要挑战

宽列主要带来了以下的三个性能挑战：
- 昂贵的恢复成本：（n，k）RS代码通过检索k个块来恢复一个块，宽列中的k很大，因此需要更多带宽和I/O，与传统的方法相比成本将增加数倍。
- 昂贵的编码成本：随着k的增加，计算开销增大，编码过程中CPU缓存有限,导致编码性能下降。
- 昂贵的更新成本：任何更新的数据块都会导致所有n-k奇偶校验块更新。

## 解决方法

面对上面三个挑战，提出了三个主要的技术点：
- 恢复方法：对于单块恢复来说，ECWide实现了组合局部性（组合了LRC和TL）的编码方法。考虑一种存储系统，给定k、f（容错数量）和γ（冗余度）。在步骤1中，ECWide通过文中给出的约束确定参数n和r。然后将k个数据块编码成n−k个局部/全局奇偶校验块。在步骤2中，ECWide为每个局部组选择(r +1)/f个机架。上述两个步骤确保了单块恢复的跨机架恢复带宽最小化。对于整个节点恢复来说，一个全节点恢复可以被看作是多个单块恢复过程，可以并行化恢复。然而多个单块恢复可能选择相同的节点作为请求者或局部恢复者，从而导致所选节点过载，降低了整体节点恢复性能。为此，ECWide设计了一个最近最少选择的方法来选择节点作为请求者或本地恢复器，并通过一个双链表和hashmap来实现该结构。
- 编码方法：为了克服单节点编码的局限性，本文考虑了一种多节点编码方案，其目标是实现宽列的编码高吞吐量。其思想是将具有大k的单节点编码操作划分为跨不同节点的小k的多个编码子操作。原因如下：(1)带有小k(例如，k = 16)的条带的编码性能很快;(2)奇偶校验块是数据块的线性组合;(3)同一机架内节点之间的带宽往往是充足的。
- 更新方法：对于全局校验块更新来说，ECWide首先在全局块Q1[1-20]的机架上传输增量块D'1->D1。它通过修改α（D'1-D1）来更新Q1[1-20]，其中α是Q1[1-20]中D1的编码系数。ECWide仅通过机架内数据传输增量块来更新另一个全局奇偶校验块Q2[1-20]。对于局部校验块更新来说，在每个条带中，ECWide会首先记录每个机架数据块的更新频率，并为每个局部组查找更新最密集的机架。通过这种方式，P1[1-5]被移动到更新最密集的机架上，这样局部奇偶校验更新可以在机架内执行，而不会引起机架间的数据传输。

## 实验结果

在Amazon EC2上的实验表明，与其他基于局部性的前沿编码方法相比，本文方法可以将单块恢复时间减少90.5%，冗余度仅为1.063×。更多的实验内容还包括了分别对ECWide-C和ECWide-H的不同网络情况下的对比实验、不同编码参数下的对比实验。实验验证了编码方法和更新方案的有效性等。在本文中，作者提出了组合局部性的宽列方法，这是第一个通过结合奇偶校验局部性和拓扑局部性来系统地解决宽列恢复问题的机制。本文进一步利用有效的编码方法和更新方案增强了组合局部性。通过具体实现和实验验证了方法有效。
 
了解更多请关注: [论文原文及ppt](https://www.usenix.org/conference/fast21/presentation/hu) 